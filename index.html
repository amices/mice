<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multivariate Imputation by Chained Equations • mice</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Multivariate Imputation by Chained Equations">
<meta name="description" content="Multiple imputation using Fully Conditional Specification (FCS) implemented by the MICE algorithm as described in Van Buuren and Groothuis-Oudshoorn (2011) &lt;doi:10.18637/jss.v045.i03&gt;. Each variable has its own imputation model. Built-in imputation models are provided for continuous data (predictive mean matching, normal), binary data (logistic regression), unordered categorical data (polytomous logistic regression) and ordered categorical data (proportional odds). MICE can also impute continuous two-level data (normal model, pan, second-level variables). Passive imputation can be used to maintain consistency between variables. Various diagnostic plots are available to inspect the quality of the imputations.">
<meta property="og:description" content="Multiple imputation using Fully Conditional Specification (FCS) implemented by the MICE algorithm as described in Van Buuren and Groothuis-Oudshoorn (2011) &lt;doi:10.18637/jss.v045.i03&gt;. Each variable has its own imputation model. Built-in imputation models are provided for continuous data (predictive mean matching, normal), binary data (logistic regression), unordered categorical data (polytomous logistic regression) and ordered categorical data (proportional odds). MICE can also impute continuous two-level data (normal model, pan, second-level variables). Passive imputation can be used to maintain consistency between variables. Various diagnostic plots are available to inspect the quality of the imputations.">
<meta property="og:image" content="https://amices.org/mice/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mice</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.16.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="articles/oldfriends.html">Help for old friends</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/amices/mice/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="mice-">mice 
<a class="anchor" aria-label="anchor" href="#mice-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="multivariate-imputation-by-chained-equations">
<a href="https://amices.org/mice/">Multivariate Imputation by Chained Equations</a><a class="anchor" aria-label="anchor" href="#multivariate-imputation-by-chained-equations"></a>
</h2>
<p>The <a href="https://cran.r-project.org/package=mice" class="external-link"><code>mice</code></a> package implements a method to deal with missing data. The package creates multiple imputations (replacement values) for multivariate missing data. The method is based on Fully Conditional Specification, where each incomplete variable is imputed by a separate model. The <code>MICE</code> algorithm can impute mixes of continuous, binary, unordered categorical and ordered categorical data. In addition, MICE can impute continuous two-level data, and maintain consistency between imputations by means of passive imputation. Many diagnostic plots are implemented to inspect the quality of the imputations.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>mice</code> package can be installed from CRAN as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mice"</span><span class="op">)</span></span></code></pre></div>
<p>The latest version can be installed from GitHub as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"amices/mice"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="minimal-example">Minimal example<a class="anchor" aria-label="anchor" href="#minimal-example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice" class="external-link">mice</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show the missing data pattern</span></span>
<span><span class="fu"><a href="reference/md.pattern.html">md.pattern</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span></span></code></pre></div>
<figure><img src="reference/figures/README-pattern-1.png" alt="Missing data pattern of nhanes data. Blue is observed, red is missing."><figcaption aria-hidden="true">
Missing data pattern of <code>nhanes</code> data. Blue is observed, red is missing.
</figcaption></figure><div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#&gt;    age hyp bmi chl   </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; 13   1   1   1   1  0</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 3    1   1   1   0  1</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 1    1   1   0   1  1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 1    1   0   0   1  2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 7    1   0   0   0  3</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;      0   8   9  10 27</span></span></code></pre></div>
<p>The table and the graph summarize where the missing data occur in the <code>nhanes</code> dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiple impute the missing values</span></span>
<span><span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mice.html">mice</a></span><span class="op">(</span><span class="va">nhanes</span>, maxit <span class="op">=</span> <span class="fl">2</span>, m <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  iter imp variable</span></span>
<span><span class="co">#&gt;   1   1  bmi  hyp  chl</span></span>
<span><span class="co">#&gt;   1   2  bmi  hyp  chl</span></span>
<span><span class="co">#&gt;   2   1  bmi  hyp  chl</span></span>
<span><span class="co">#&gt;   2   2  bmi  hyp  chl</span></span>
<span></span>
<span><span class="co"># inspect quality of imputations</span></span>
<span><span class="fu"><a href="reference/stripplot.mids.html">stripplot</a></span><span class="op">(</span><span class="va">imp</span>, <span class="va">chl</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"Imputation number"</span><span class="op">)</span></span></code></pre></div>
<figure><img src="reference/figures/README-stripplot-1.png" alt="Distribution of chl per imputed data set."><figcaption aria-hidden="true">
Distribution of <code>chl</code> per imputed data set.
</figcaption></figure><p>In general, we would like the imputations to be plausible, i.e., values that could have been observed if they had not been missing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit complete-data model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">imp</span>, <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">chl</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">bmi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pool and summarize the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="reference/pool.html">pool</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          term estimate std.error statistic    df p.value</span></span>
<span><span class="co">#&gt; 1 (Intercept)     9.08     73.09     0.124  4.50  0.9065</span></span>
<span><span class="co">#&gt; 2         age    35.23     17.46     2.017  1.36  0.2377</span></span>
<span><span class="co">#&gt; 3         bmi     4.69      1.94     2.417 15.25  0.0286</span></span></code></pre></div>
<p>The complete-data is fit to each imputed dataset, and the results are combined to arrive at estimates that properly account for the missing data.</p>
</div>
<div class="section level2">
<h2 id="mice-30">
<code>mice 3.0</code><a class="anchor" aria-label="anchor" href="#mice-30"></a>
</h2>
<p>Version 3.0 represents a major update that implements the following features:</p>
<ol style="list-style-type: decimal">
<li><p><code>blocks</code>: The main algorithm iterates over blocks. A block is simply a collection of variables. In the common MICE algorithm each block was equivalent to one variable, which - of course - is the default; The <code>blocks</code> argument allows mixing univariate imputation method multivariate imputation methods. The <code>blocks</code> feature bridges two seemingly disparate approaches, joint modeling and fully conditional specification, into one framework;</p></li>
<li><p><code>where</code>: The <code>where</code> argument is a logical matrix of the same size of <code>data</code> that specifies which cells should be imputed. This opens up some new analytic possibilities;</p></li>
<li><p>Multivariate tests: There are new functions <code><a href="reference/D1.html">D1()</a></code>, <code><a href="reference/D2.html">D2()</a></code>, <code><a href="reference/D3.html">D3()</a></code> and <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> that perform multivariate parameter tests on the repeated analysis from on multiply-imputed data;</p></li>
<li><p><code>formulas</code>: The old <code>form</code> argument has been redesign and is now renamed to <code>formulas</code>. This provides an alternative way to specify imputation models that exploits the full power of R’s native formula’s.</p></li>
<li><p>Better integration with the <code>tidyverse</code> framework, especially for packages <code>dplyr</code>, <code>tibble</code> and <code>broom</code>;</p></li>
<li><p>Improved numerical algorithms for low-level imputation function. Better handling of duplicate variables.</p></li>
<li><p>Last but not least: A brand new edition AND online version of <a href="https://stefvanbuuren.name/fimd/" class="external-link">Flexible Imputation of Missing Data. Second Edition.</a></p></li>
</ol>
<p>See <a href="https://amices.org/mice/">MICE: Multivariate Imputation by Chained Equations</a> for more resources.</p>
<p>I’ll be happy to take feedback and discuss suggestions. Please submit these through Github’s issues facility.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<div class="section level3">
<h3 id="books">Books<a class="anchor" aria-label="anchor" href="#books"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Van Buuren, S. (2018). <a href="https://stefvanbuuren.name/fimd/" class="external-link">Flexible Imputation of Missing Data. Second Edition.</a>. Chapman &amp; Hall/CRC. Boca Raton, FL.</li>
</ol>
</div>
<div class="section level3">
<h3 id="course-materials">Course materials<a class="anchor" aria-label="anchor" href="#course-materials"></a>
</h3>
<ol style="list-style-type: decimal">
<li><a href="https://amices.org/Winnipeg/" class="external-link">Handling Missing Data in <code>R</code> with <code>mice</code></a></li>
<li><a href="https://stefvanbuuren.name/RECAPworkshop/" class="external-link">Statistical Methods for combined data sets</a></li>
</ol>
</div>
<div class="section level3">
<h3 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h3>
<ol style="list-style-type: decimal">
<li><a href="https://www.gerkovink.com/miceVignettes/Ad_hoc_and_mice/Ad_hoc_methods.html" class="external-link">Ad hoc methods and the MICE algorithm</a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/Convergence_pooling/Convergence_and_pooling.html" class="external-link">Convergence and pooling</a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/Missingness_inspection/Missingness_inspection.html" class="external-link">Inspecting how the observed data and missingness are related</a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/Passive_Post_processing/Passive_imputation_post_processing.html" class="external-link">Passive imputation and post-processing</a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/Multi_level/Multi_level_data.html" class="external-link">Imputing multilevel data</a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/Sensitivity_analysis/Sensitivity_analysis.html" class="external-link">Sensitivity analysis with <code>mice</code></a></li>
<li><a href="https://rianneschouten.github.io/mice_ampute/vignette/ampute.html" class="external-link">Generate missing values with <code>ampute</code></a></li>
<li><a href="https://www.gerkovink.com/miceVignettes/futuremice/Vignette_futuremice.html" class="external-link"><code>futuremice</code>: Wrapper for parallel MICE imputation through futures</a></li>
</ol>
</div>
<div class="section level3">
<h3 id="code-from-publications">Code from publications<a class="anchor" aria-label="anchor" href="#code-from-publications"></a>
</h3>
<ol style="list-style-type: decimal">
<li><a href="https://github.com/stefvanbuuren/fimdbook/tree/master/R" class="external-link">Flexible Imputation of Missing Data. Second edition.</a></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgement">Acknowledgement<a class="anchor" aria-label="anchor" href="#acknowledgement"></a>
</h2>
<p>The cute mice sticker was designed by Jaden M. Walters. Thanks Jaden!</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the mice project is released with a <a href="https://amices.org/mice/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=mice" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/amices/mice/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/amices/mice/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 2)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mice</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stef van Buuren <br><small class="roles"> Author, maintainer </small>  </li>
<li>Karin Groothuis-Oudshoorn <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=mice" class="external-link"><img src="https://www.r-pkg.org/badges/version/mice" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=mice" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/mice"></a></li>
<li><a href="https://github.com/amices/mice/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/amices/mice/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://amices.org/mice/"><img src="https://img.shields.io/badge/github%20version-3.16.15-orange.svg"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stef van Buuren, Karin Groothuis-Oudshoorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
