<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Test whether missingness is contingent upon the observed variables,
according to the methodology developed by Jamshidian and Jalal (2010) (see
Details)."><title>Jamshidian and Jalal's Non-Parametric MCAR Test — mcar • mice</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Jamshidian and Jalal's Non-Parametric MCAR Test — mcar"><meta property="og:description" content="Test whether missingness is contingent upon the observed variables,
according to the methodology developed by Jamshidian and Jalal (2010) (see
Details)."><meta property="og:image" content="https://amices.org/mice/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mice</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.16.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/oldfriends.html">Help for old friends</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/amices/mice/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Jamshidian and Jalal's Non-Parametric MCAR Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/amices/mice/blob/HEAD/R/mcar.R" class="external-link"><code>R/mcar.R</code></a></small>
      <div class="d-none name"><code>MCAR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Test whether missingness is contingent upon the observed variables,
according to the methodology developed by Jamshidian and Jalal (2010) (see
Details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcar</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  imputed <span class="op">=</span> <span class="fu"><a href="mice.html">mice</a></span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span>,</span>
<span>  min_n <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  replications <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  use_chisq <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An object for which a method exists; usually a <code>data.frame</code>.</p></dd>


<dt>imputed</dt>
<dd><p>Either an object of class <code>mids</code>, as returned by
<code><a href="mice.html">mice()</a></code>, or a list of <code>data.frame</code>s.</p></dd>


<dt>min_n</dt>
<dd><p>Atomic numeric, must be greater than 1. When there are missing
data patterns with fewer than <code>min_n</code> cases, all cases with that pattern will
be removed from <code>x</code> and <code>imputed</code>.</p></dd>


<dt>method</dt>
<dd><p>Atomic character. If it is known (or assumed) that data are
either multivariate normally distributed or not, then use either
<code>method = "hawkins"</code> or <code>method = "nonparametric"</code>, respectively.
The default argument <code>method = "auto"</code> follows the procedure outlined in the
Details section, and in Figure 7 of Jamshidian and Jalal (2010).</p></dd>


<dt>replications</dt>
<dd><p>Number of replications used to simulate the Neyman
distribution when performing Hawkins' test. As this method is based on random
sampling, use a high number of <code>replications</code> (and optionally,
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>) to minimize Monte Carlo error and ensure reproducibility.</p></dd>


<dt>use_chisq</dt>
<dd><p>Atomic integer, indicating the minimum number of cases
within a group <em>k</em> that triggers the use of asymptotic Chi-square
distribution instead of the emprical distribution in the Neyman uniformity
test, which is performed as part of Hawkins' test.</p></dd>


<dt>alpha</dt>
<dd><p>Atomic numeric, indicating the significance level of tests.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>mcar_object</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Three types of missingness have been distinguished in the literature
(Rubin, 1976):
Missing completely at random (MCAR), which means that missingness is random;
missing at random (MAR), which means that missingness is contingent on the
<em>observed</em>;
and missing not at random (MNAR), which means that missingness is related to
unobserved data.</p>
<p>Jamshidian and Jalal's non-parametric MCAR test assumes that the missing data
are either MCAR or MAR, and tests whether the missingness is independent of
the observed values. If so, the covariance matrices of the imputed data will
be equal accross groups with different patterns of missingness. This test
consists of the following procedure:</p><ol><li><p>Data are imputed.</p></li>
<li><p>The imputed data are split into <em>k</em> groups according to the
<em>k</em> missing data patterns in the original data (see
<code><a href="md.pattern.html">md.pattern()</a></code>).</p></li>
<li><p>Perform Hawkins' test for equality of covariances across the <em>k</em>
groups.</p></li>
<li><p>If the test is <em>not significant</em>, conclude that there is no evidence
against multivariate normality of the data, nor against MCAR.</p></li>
<li><p>If the test <em>is significant</em>, and multivariate normality of the data
can be assumed, then it can be concluded that missingness is MAR.</p></li>
<li><p>If multivariate normality cannot be assumed, then perform the
Anderson-Darling non-parametric test for equality of covariances across the
<em>k</em> groups.</p></li>
<li><p>If the Anderson-Darling test is <em>not significant</em>, this is evidence
against multivariate normality - but no evidence against MCAR.</p></li>
<li><p>If the Anderson-Darling test <em>is significant</em>, this is evidence
it can be concluded that missingness is MAR.</p></li>
</ol><p>Note that, despite its name in common parlance, an MCAR test can only
indicate whether missingness is MCAR or MAR. The procedure cannot distinguish
MCAR from MNAR, so a non-significant result does not rule out MNAR.</p>
<p>This is a re-implementation of the function <code>TestMCARNormality</code>, which was
originally published in the R-packgage <code>MissMech</code>, which has been removed
from CRAN. This new implementation is faster, as its backend is written in
C++. It also enhances the functionality of the original:</p><ul><li><p>Multiply imputed data can now be used; the median p-value and test
statistic across replications is then reported, as suggested by
Eekhout, Wiel, and Heymans (2017).</p></li>
<li><p>The printing method for an <code>mcar_object</code> gives a warning when at
least one p-value of either test was significant. In this case, it is
recommended to inspect the range of p-values, and consider potential
violations of MCAR.</p></li>
<li><p>A plotting method for an <code>mcar_object</code> is provided.</p></li>
<li><p>A plotting method for the <code>$md.pattern</code> element of an <code>mcar_object</code>
is provided.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rubin, D. B. (1976). Inference and Missing Data. Biometrika, Vol. 63, No. 3,
pp. 581-592. <a href="https://doi.org/10.2307/2335739" class="external-link">doi:10.2307/2335739</a></p>
<p>Eekhout, I., M. A. Wiel, &amp; M. W. Heymans (2017). Methods for Significance
Testing of Categorical Covariates in Logistic Regression Models After
Multiple Imputation: Power and Applicability Analysis. BMC Medical Research
Methodology 17 (1): 129.</p>
<p>Jamshidian, M., &amp; Jalal, S. (2010). Tests of homoscedasticity, normality, and
missing completely at random for incomplete multivariate data. Psychometrika,
75(4), 649–674. <a href="https://doi.org/10.1007/s11336-010-9175-3" class="external-link">doi:10.1007/s11336-010-9175-3</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Caspar J. Van Lissa</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mcar</span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iter imp variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   1  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   3  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   4  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   5  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   1  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   2  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   3  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   4  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   5  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   1  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   2  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   3  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   4  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3   5  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   1  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   2  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   3  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   4  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   5  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   1  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   2  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   3  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   4  bmi  hyp  chl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   5  bmi  hyp  chl</span>
<span class="r-in"><span><span class="co"># Examine test results</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing data patterns: 2 used, 3 removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cases used: 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hawkins' test: median chi^2 (4) = 2.041792, median p = 0.7280723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interpretation of results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hawkins' test is not significant; there is no evidence to reject the assumptions of multivariate normality and MCAR.</span>
<span class="r-in"><span><span class="co"># Plot p-values across imputed data sets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot md patterns used for the test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type <span class="op">=</span> <span class="st">"md.pattern"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Note difference with the raw md.patterns:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="md.pattern.html">md.pattern</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    age hyp bmi chl   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   1   1   1   1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1   1   1   0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1   1   0   1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1   0   0   1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    1   0   0   0  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0   8   9  10 27</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stef van Buuren, Karin Groothuis-Oudshoorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

