<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>mice: Multivariate Imputation by Chained Equations — mice • mice</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="mice: Multivariate Imputation by Chained Equations — mice" />
<meta property="og:description" content="The mice package implements a method to deal with missing data.
The package creates multiple imputations (replacement values) for
multivariate missing data. The method is based on Fully Conditional
Specification, where each incomplete variable is imputed by a separate
model. The MICE algorithm can impute mixes of continuous, binary,
unordered categorical and ordered categorical data. In addition, MICE
can impute continuous two-level data, and maintain consistency between
imputations by means of passive imputation. Many diagnostic plots are
implemented to inspect the quality of the imputations.
Generates Multivariate Imputations by Chained Equations (MICE)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mice</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.13.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/oldfriends.html">Help for old friends</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/amices/mice/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1><span class="pkg">mice</span>: Multivariate Imputation by Chained Equations</h1>
    <small class="dont-index">Source: <a href='https://github.com/amices/mice/blob/master/R/mice-package.R'><code>R/mice-package.R</code></a>, <a href='https://github.com/amices/mice/blob/master/R/mice.R'><code>R/mice.R</code></a></small>
    <div class="hidden name"><code>mice.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <span class="pkg">mice</span> package implements a method to deal with missing data.
The package creates multiple imputations (replacement values) for
multivariate missing data. The method is based on Fully Conditional
Specification, where each incomplete variable is imputed by a separate
model. The MICE algorithm can impute mixes of continuous, binary,
unordered categorical and ordered categorical data. In addition, MICE
can impute continuous two-level data, and maintain consistency between
imputations by means of passive imputation. Many diagnostic plots are
implemented to inspect the quality of the imputations.</p>
<p>Generates Multivariate Imputations by Chained Equations (MICE)</p>
    </div>

    <pre class="usage"><span class='fu'>mice</span><span class='op'>(</span>
  <span class='va'>data</span>,
  m <span class='op'>=</span> <span class='fl'>5</span>,
  method <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>predictorMatrix</span>,
  ignore <span class='op'>=</span> <span class='cn'>NULL</span>,
  where <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>blocks</span>,
  visitSequence <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>formulas</span>,
  blots <span class='op'>=</span> <span class='cn'>NULL</span>,
  post <span class='op'>=</span> <span class='cn'>NULL</span>,
  defaultMethod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pmm"</span>, <span class='st'>"logreg"</span>, <span class='st'>"polyreg"</span>, <span class='st'>"polr"</span><span class='op'>)</span>,
  maxit <span class='op'>=</span> <span class='fl'>5</span>,
  printFlag <span class='op'>=</span> <span class='cn'>TRUE</span>,
  seed <span class='op'>=</span> <span class='cn'>NA</span>,
  data.init <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame or a matrix containing the incomplete data.  Missing
values are coded as <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>Number of multiple imputations. The default is <code>m=5</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Can be either a single string, or a vector of strings with
length <code>length(blocks)</code>, specifying the imputation method to be
used for each column in data. If specified as a single string, the same
method will be used for all blocks. The default imputation method (when no
argument is specified) depends on the measurement level of the target column,
as regulated by the <code>defaultMethod</code> argument. Columns that need
not be imputed have the empty method <code>""</code>. See details.</p></td>
    </tr>
    <tr>
      <th>predictorMatrix</th>
      <td><p>A numeric matrix of <code>length(blocks)</code> rows
and <code>ncol(data)</code> columns, containing 0/1 data specifying
the set of predictors to be used for each target column.
Each row corresponds to a variable block, i.e., a set of variables
to be imputed. A value of <code>1</code> means that the column
variable is used as a predictor for the target block (in the rows).
By default, the <code>predictorMatrix</code> is a square matrix of <code>ncol(data)</code>
rows and columns with all 1's, except for the diagonal.
Note: For two-level imputation models (which have <code>"2l"</code> in their names)
other codes (e.g, <code>2</code> or <code>-2</code>) are also allowed.</p></td>
    </tr>
    <tr>
      <th>ignore</th>
      <td><p>A logical vector of <code>nrow(data)</code> elements indicating
which rows are ignored when creating the imputation model. The default
<code>NULL</code> includes all rows that have an observed value of the variable
to imputed. Rows with <code>ignore</code> set to <code>TRUE</code> do not influence the
parameters of the imputation model, but are still imputed. We may use the
<code>ignore</code> argument to split <code>data</code> into a training set (on which the
imputation model is built) and a test set (that does not influence the
imputation model estimates).
Note: Multivariate imputation methods, like <code><a href='mice.impute.jomoImpute.html'>mice.impute.jomoImpute()</a></code>
or <code><a href='mice.impute.panImpute.html'>mice.impute.panImpute()</a></code>, do not honour the <code>ignore</code> argument.</p></td>
    </tr>
    <tr>
      <th>where</th>
      <td><p>A data frame or matrix with logicals of the same dimensions
as <code>data</code> indicating where in the data the imputations should be
created. The default, <code>where = is.na(data)</code>, specifies that the
missing data should be imputed. The <code>where</code> argument may be used to
overimpute observed data, or to skip imputations for selected missing values.</p></td>
    </tr>
    <tr>
      <th>blocks</th>
      <td><p>List of vectors with variable names per block. List elements
may be named to identify blocks. Variables within a block are
imputed by a multivariate imputation method
(see <code>method</code> argument). By default each variable is placed
into its own block, which is effectively
fully conditional specification (FCS) by univariate models
(variable-by-variable imputation). Only variables whose names appear in
<code>blocks</code> are imputed. The relevant columns in the <code>where</code>
matrix are set to <code>FALSE</code> of variables that are not block members.
A variable may appear in multiple blocks. In that case, it is
effectively re-imputed each time that it is visited.</p></td>
    </tr>
    <tr>
      <th>visitSequence</th>
      <td><p>A vector of block names of arbitrary length, specifying the
sequence of blocks that are imputed during one iteration of the Gibbs
sampler. A block is a collection of variables. All variables that are
members of the same block are imputed
when the block is visited. A variable that is a member of multiple blocks
is re-imputed within the same iteration.
The default <code>visitSequence = "roman"</code> visits the blocks (left to right)
in the order in which they appear in <code>blocks</code>.
One may also use one of the following keywords: <code>"arabic"</code>
(right to left), <code>"monotone"</code> (ordered low to high proportion
of missing data) and <code>"revmonotone"</code> (reverse of monotone).
<em>Special case</em>: If you specify both <code>visitSequence = "monotone"</code> and
<code>maxit = 1</code>, then the procedure will edit the <code>predictorMatrix</code>
to conform to the monotone pattern. Realize that convergence in one
iteration is only guaranteed if the missing data pattern is actually
monotone. The procedure does not check this.</p></td>
    </tr>
    <tr>
      <th>formulas</th>
      <td><p>A named list of formula's, or expressions that
can be converted into formula's by <code>as.formula</code>. List elements
correspond to blocks. The block to which the list element applies is
identified by its name, so list names must correspond to block names.
The <code>formulas</code> argument is an alternative to the
<code>predictorMatrix</code> argument that allows for more flexibility in
specifying imputation models, e.g., for specifying interaction terms.</p></td>
    </tr>
    <tr>
      <th>blots</th>
      <td><p>A named <code>list</code> of <code>alist</code>'s that can be used
to pass down arguments to lower level imputation function. The entries
of element <code>blots[[blockname]]</code> are passed down to the function
called for block <code>blockname</code>.</p></td>
    </tr>
    <tr>
      <th>post</th>
      <td><p>A vector of strings with length <code>ncol(data)</code> specifying
expressions as strings. Each string is parsed and
executed within the <code>sampler()</code> function to post-process
imputed values during the iterations.
The default is a vector of empty strings, indicating no post-processing.
Multivariate (block) imputation methods ignore the <code>post</code> parameter.</p></td>
    </tr>
    <tr>
      <th>defaultMethod</th>
      <td><p>A vector of length 4 containing the default
imputation methods for 1) numeric data, 2) factor data with 2 levels, 3)
factor data with &gt; 2 unordered levels, and 4) factor data with &gt; 2
ordered levels. By default, the method uses
<code>pmm</code>, predictive mean matching (numeric data) <code>logreg</code>, logistic
regression imputation (binary data, factor with 2 levels) <code>polyreg</code>,
polytomous regression imputation for unordered categorical data (factor &gt; 2
levels) <code>polr</code>, proportional odds model for (ordered, &gt; 2 levels).</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>A scalar giving the number of iterations. The default is 5.</p></td>
    </tr>
    <tr>
      <th>printFlag</th>
      <td><p>If <code>TRUE</code>, <code>mice</code> will print history on console.
Use <code>print=FALSE</code> for silent computation.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>An integer that is used as argument by the <code><a href='https://rdrr.io/r/base/Random.html'>set.seed()</a></code> for
offsetting the random number generator. Default is to leave the random number
generator alone. Versions later than 3.13.11 reset the random generator to the
state before calling <code>mice()</code>. This effectively isolates the <code>mice</code>
random generator from the calling environment.</p></td>
    </tr>
    <tr>
      <th>data.init</th>
      <td><p>A data frame of the same size and type as <code>data</code>,
without missing data, used to initialize imputations before the start of the
iterative process.  The default <code>NULL</code> implies that starting imputation
are created by a simple random draw from the data. Note that specification of
<code>data.init</code> will start all <code>m</code> Gibbs sampling streams from the same
imputation.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Named arguments that are passed down to the univariate imputation
functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an S3 object of class <code><a href='mids-class.html'>mids</a></code>
       (multiply imputed data set)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <span class="pkg">mice</span> package contains functions to</p><ul>
<li><p>Inspect the missing data pattern</p></li>
<li><p>Impute the missing data <em>m</em> times, resulting in <em>m</em> completed data sets</p></li>
<li><p>Diagnose the quality of the imputed values</p></li>
<li><p>Analyze each completed data set</p></li>
<li><p>Pool the results of the repeated analyses</p></li>
<li><p>Store and export the imputed data in various formats</p></li>
<li><p>Generate simulated incomplete data</p></li>
<li><p>Incorporate custom imputation methods</p></li>
</ul>

<p>Generates multiple imputations for incomplete multivariate data by Gibbs
sampling. Missing data can occur anywhere in the data. The algorithm imputes
an incomplete column (the target column) by generating 'plausible' synthetic
values given other columns in the data. Each incomplete column must act as a
target column, and has its own specific set of predictors. The default set of
predictors for a given target consists of all other columns in the data. For
predictors that are incomplete themselves, the most recently generated
imputations are used to complete the predictors prior to imputation of the
target column.</p>
<p>A separate univariate imputation model can be specified for each column. The
default imputation method depends on the measurement level of the target
column. In addition to these, several other methods are provided. You can
also write their own imputation functions, and call these from within the
algorithm.</p>
<p>The data may contain categorical variables that are used in a regressions on
other variables. The algorithm creates dummy variables for the categories of
these variables, and imputes these from the corresponding categorical
variable.</p>
<p>Built-in univariate imputation methods are:</p>
<table class='table'>
<tr><td><code>pmm</code></td><td>any</td><td>Predictive mean matching</td></tr>
<tr><td><code>midastouch</code></td><td>any</td><td>Weighted predictive mean matching</td></tr>
<tr><td><code>sample</code></td><td>any</td><td>Random sample from observed values</td></tr>
<tr><td><code>cart</code></td><td>any</td><td>Classification and regression trees</td></tr>
<tr><td><code>rf</code></td><td>any</td><td>Random forest imputations</td></tr>
<tr><td><code>mean</code></td><td>numeric</td><td>Unconditional mean imputation</td></tr>
<tr><td><code>norm</code></td><td>numeric</td><td>Bayesian linear regression</td></tr>
<tr><td><code>norm.nob</code></td><td>numeric</td><td>Linear regression ignoring model error</td></tr>
<tr><td><code>norm.boot</code></td><td>numeric</td><td>Linear regression using bootstrap</td></tr>
<tr><td><code>norm.predict</code></td><td>numeric</td><td>Linear regression, predicted values</td></tr>
<tr><td><code>lasso.norm</code></td><td>numeric</td><td>Lasso linear regression</td></tr>
<tr><td><code>lasso.select.norm</code></td><td>numeric</td><td>Lasso select + linear regression</td></tr>
<tr><td><code>quadratic</code></td><td>numeric</td><td>Imputation of quadratic terms</td></tr>
<tr><td><code>ri</code></td><td>numeric</td><td>Random indicator for nonignorable data</td></tr>
<tr><td><code>logreg</code></td><td>binary</td><td>Logistic regression</td></tr>
<tr><td><code>logreg.boot</code></td><td>binary</td><td>Logistic regression with bootstrap</td></tr>
<tr><td><code>lasso.logreg</code></td><td>binary</td><td>Lasso logistic regression</td></tr>
<tr><td><code>lasso.select.logreg</code></td><td>binary</td><td>Lasso select + logistic regression</td></tr>
<tr><td><code>polr</code></td><td>ordered</td><td>Proportional odds model</td></tr>
<tr><td><code>polyreg</code></td><td>unordered</td><td>Polytomous logistic regression</td></tr>
<tr><td><code>lda</code></td><td>unordered</td><td>Linear discriminant analysis</td></tr>
<tr><td><code>2l.norm</code></td><td>numeric</td><td>Level-1 normal heteroscedastic</td></tr>
<tr><td><code>2l.lmer</code></td><td>numeric</td><td>Level-1 normal homoscedastic, lmer</td></tr>
<tr><td><code>2l.pan</code></td><td>numeric</td><td>Level-1 normal homoscedastic, pan</td></tr>
<tr><td><code>2l.bin</code></td><td>binary</td><td>Level-1 logistic, glmer</td></tr>
<tr><td><code>2lonly.mean</code></td><td>numeric</td><td>Level-2 class mean</td></tr>
<tr><td><code>2lonly.norm</code></td><td>numeric</td><td>Level-2 class normal</td></tr>
<tr><td><code>2lonly.pmm</code></td><td>any</td><td>Level-2 class predictive mean matching</td></tr>
</table>


<p>These corresponding functions are coded in the <code>mice</code> library under
names <code>mice.impute.method</code>, where <code>method</code> is a string with the
name of the univariate imputation method name, for example <code>norm</code>. The
<code>method</code> argument specifies the methods to be used.  For the <code>j</code>'th
column, <code>mice()</code> calls the first occurrence of
<code>paste('mice.impute.', method[j], sep = '')</code> in the search path.  The
mechanism allows uses to write customized imputation function,
<code>mice.impute.myfunc</code>. To call it for all columns specify
<code>method='myfunc'</code>.  To call it only for, say, column 2 specify
<code>method=c('norm','myfunc','logreg',...{})</code>.</p>
<p><em>Skipping imputation:</em> The user may skip imputation of a column by
setting its entry to the empty method: <code>""</code>. For complete columns without
missing data <code>mice</code> will automatically set the empty method. Setting t
he empty method does not produce imputations for the column, so any missing
cells remain <code>NA</code>. If column A contains <code>NA</code>'s and is used as
predictor in the imputation model for column B, then <code>mice</code> produces no
imputations for the rows in B where A is missing. The imputed data
for B may thus contain <code>NA</code>'s. The remedy is to remove column A from
the imputation model for the other columns in the data. This can be done
by setting the entire column for variable A in the <code>predictorMatrix</code>
equal to zero.</p>
<p><em>Passive imputation:</em> <code>mice()</code> supports a special built-in method,
called passive imputation. This method can be used to ensure that a data
transform always depends on the most recently generated imputations.  In some
cases, an imputation model may need transformed data in addition to the
original data (e.g. log, quadratic, recodes, interaction, sum scores, and so
on).</p>
<p>Passive imputation maintains consistency among different transformations of
the same data. Passive imputation is invoked if <code>~</code> is specified as the
first character of the string that specifies the univariate method.
<code>mice()</code> interprets the entire string, including the <code>~</code> character,
as the formula argument in a call to <code>model.frame(formula,
data[!r[,j],])</code>. This provides a simple mechanism for specifying deterministic
dependencies among the columns. For example, suppose that the missing entries
in variables <code>data$height</code> and <code>data$weight</code> are imputed. The body
mass index (BMI) can be calculated within <code>mice</code> by specifying the
string <code>'~I(weight/height^2)'</code> as the univariate imputation method for
the target column <code>data$bmi</code>.  Note that the <code>~</code> mechanism works
only on those entries which have missing values in the target column. You
should make sure that the combined observed and imputed parts of the target
column make sense. An easy way to create consistency is by coding all entries
in the target as <code>NA</code>, but for large data sets, this could be
inefficient.  Note that you may also need to adapt the default
<code>predictorMatrix</code> to evade linear dependencies among the predictors that
could cause errors like <code>Error in solve.default()</code> or <code>Error:
system is exactly singular</code>. Though not strictly needed, it is often useful
to specify <code>visitSequence</code> such that the column that is imputed by the
<code>~</code> mechanism is visited each time after one of its predictors was
visited. In that way, deterministic relation between columns will always be
synchronized.</p>
<p>#'A new argument <code>ls.meth</code> can be parsed to the lower level
<code>.norm.draw</code> to specify the method for generating the least squares
estimates and any subsequently derived estimates. Argument <code>ls.meth</code>
takes one of three inputs: <code>"qr"</code> for QR-decomposition, <code>"svd"</code> for
singular value decomposition and <code>"ridge"</code> for ridge regression.
<code>ls.meth</code> defaults to <code>ls.meth = "qr"</code>.</p>
<p><em>Auxiliary predictors in formulas specification: </em>
For a given block, the <code>formulas</code> specification takes precedence over
the corresponding row in the <code>predictMatrix</code> argument. This
precedence is, however, restricted to the subset of variables
specified in the terms of the block formula. Any
variables not specified by <code>formulas</code> are imputed
according to the <code>predictMatrix</code> specification. Variables with
non-zero <code>type</code> values in the <code>predictMatrix</code> will
be added as main effects to the <code>formulas</code>, which will
act as supplementary covariates in the imputation model. It is possible
to turn off this behavior by specifying the
argument <code>auxiliary = FALSE</code>.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    


<p>The main functions are:</p><table class='table'>
<tr><td><code>mice()</code></td><td>Impute the missing data *m* times</td></tr>
<tr><td><code><a href='https://rdrr.io/r/base/with.html'>with()</a></code></td><td>Analyze completed data sets</td></tr>
<tr><td><code><a href='pool.html'>pool()</a></code></td><td>Combine parameter estimates</td></tr>
<tr><td><code><a href='complete.mids.html'>complete()</a></code></td><td>Export imputed data</td></tr>
<tr><td><code><a href='ampute.html'>ampute()</a></code></td><td>Generate missing data</td></tr>
</table>


    <h2 class="hasAnchor" id="vignettes"><a class="anchor" href="#vignettes"></a>Vignettes</h2>

    


<p>There is a detailed series of
six online vignettes that walk you through solving realistic inference
problems with mice.</p>
<p>We suggest going through these vignettes in the following order</p><ol>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Ad_hoc_and_mice/Ad_hoc_methods.html'>Ad hoc methods and the MICE algorithm</a></p></li>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Convergence_pooling/Convergence_and_pooling.html'>Convergence and pooling</a></p></li>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Missingness_inspection/Missingness_inspection.html'>Inspecting how the observed data and missingness are related</a></p></li>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Passive_Post_processing/Passive_imputation_post_processing.html'>Passive imputation and post-processing</a></p></li>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Multi_level/Multi_level_data.html'>Imputing multilevel data</a></p></li>
<li><p><a href='https://www.gerkovink.com/miceVignettes/Sensitivity_analysis/Sensitivity_analysis.html'>Sensitivity analysis with <span class="pkg">mice</span></a></p></li>
</ol>

<p>#'Van Buuren, S. (2018).
Boca Raton, FL.: Chapman &amp; Hall/CRC Press.
The book
<a href='https://stefvanbuuren.name/fimd/'><em>Flexible Imputation of Missing Data. Second Edition.</em></a>
contains a lot of <a href='https://github.com/stefvanbuuren/fimdbook/tree/master/R'>example code</a>.</p>
    <h2 class="hasAnchor" id="methodology"><a class="anchor" href="#methodology"></a>Methodology</h2>

    


<p>The <span class="pkg">mice</span> software was published in the <a href='https://www.jstatsoft.org/article/view/v045i03'>Journal of Statistical Software</a> (Van Buuren and Groothuis-Oudshoorn, 2011).
The first application of the method
concerned missing blood pressure data (Van Buuren et. al., 1999).
The term <em>Fully Conditional Specification</em> was introduced in 2006 to describe a general class of methods that specify imputations model for multivariate data as a set of conditional distributions (Van Buuren et. al., 2006). Further details on mixes of variables and applications can be found in the book
<a href='https://stefvanbuuren.name/fimd/'><em>Flexible Imputation of Missing Data. Second Edition.</em></a>
Chapman &amp; Hall/CRC. Boca Raton, FL.</p>
    <h2 class="hasAnchor" id="enhanced-linear-algebra"><a class="anchor" href="#enhanced-linear-algebra"></a>Enhanced linear algebra</h2>

    


<p>Updating the BLAS can improve speed of R, sometime considerably. The details
depend on the operating system. See the discussion in the
"R Installation and Administration" guide for further information.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>van Buuren, S., Boshuizen, H.C., Knook, D.L. (1999) Multiple
imputation of missing blood pressure covariates in survival analysis.
<em>Statistics in Medicine</em>, <b>18</b>, 681--694.</p>
<p>van Buuren, S., Brand, J.P.L., Groothuis-Oudshoorn C.G.M., Rubin, D.B. (2006)
Fully conditional specification in multivariate imputation.  <em>Journal of
Statistical Computation and Simulation</em>, <b>76</b>, 12, 1049--1064.</p>
<p>van Buuren, S., Groothuis-Oudshoorn, K. (2011). <a href='https://www.jstatsoft.org/v45/i03/'><code>mice</code>:
Multivariate Imputation by Chained Equations in <code>R</code></a>. <em>Journal of
Statistical Software</em>, <b>45</b>(3), 1--67.</p>
<p>Van Buuren, S. (2018).
<a href='https://stefvanbuuren.name/fimd/'><em>Flexible Imputation of Missing Data. Second Edition.</em></a>
Chapman &amp; Hall/CRC. Boca Raton, FL.</p>
<p>Van Buuren, S., Groothuis-Oudshoorn, K. (2011). <code>mice</code>:
Multivariate Imputation by Chained Equations in <code>R</code>. <em>Journal of
Statistical Software</em>, <b>45</b>(3), 1-67.
<a href='https://www.jstatsoft.org/v45/i03/'>https://www.jstatsoft.org/v45/i03/</a></p>
<p>Van Buuren, S. (2018).
<a href='https://stefvanbuuren.name/fimd/sec-FCS.html#sec:MICE'><em>Flexible Imputation of Missing Data. Second Edition.</em></a>
Chapman &amp; Hall/CRC. Boca Raton, FL.</p>
<p>Van Buuren, S., Brand, J.P.L., Groothuis-Oudshoorn C.G.M., Rubin, D.B. (2006)
Fully conditional specification in multivariate imputation.  <em>Journal of
Statistical Computation and Simulation</em>, <b>76</b>, 12, 1049--1064.</p>
<p>Van Buuren, S. (2007) Multiple imputation of discrete and continuous data by
fully conditional specification.  <em>Statistical Methods in Medical
Research</em>, <b>16</b>, 3, 219--242.</p>
<p>Van Buuren, S., Boshuizen, H.C., Knook, D.L. (1999) Multiple imputation of
missing blood pressure covariates in survival analysis.  <em>Statistics in
Medicine</em>, <b>18</b>, 681--694.</p>
<p>Brand, J.P.L. (1999) <em>Development, implementation and evaluation of
multiple imputation strategies for the statistical analysis of incomplete
data sets.</em> Dissertation. Rotterdam: Erasmus University.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>mice</code>, <code><a href='with.mids.html'>with.mids</a></code>,
<code><a href='pool.html'>pool</a></code>, <code><a href='complete.mids.html'>complete</a></code>, <code><a href='ampute.html'>ampute</a></code></p>
<p><code><a href='mids-class.html'>mids</a></code>, <code><a href='with.mids.html'>with.mids</a></code>,
<code><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></code>, <code><a href='complete.mids.html'>complete</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stef van Buuren <a href='mailto:stef.vanbuuren@tno.nl'>stef.vanbuuren@tno.nl</a>, Karin
Groothuis-Oudshoorn <a href='mailto:c.g.m.oudshoorn@utwente.nl'>c.g.m.oudshoorn@utwente.nl</a>, 2000-2010, with
contributions of Alexander Robitzsch, Gerko Vink, Shahab Jolani,
Roel de Jong, Jason Turner, Lisa Doove,
John Fox, Frank E. Harrell, and Peter Malewski.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># do default multiple imputation on a numeric matrix</span></span>
<span class='r-in'><span class='va'>imp</span> <span class='op'>&lt;-</span> <span class='fu'>mice</span><span class='op'>(</span><span class='va'>nhanes</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  iter imp variable</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   5  bmi  hyp  chl</span>
<span class='r-in'><span class='va'>imp</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Class: mids</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of multiple imputations:  5 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Imputation methods:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   age   bmi   hyp   chl </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    "" "pmm" "pmm" "pmm" </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> PredictorMatrix:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     age bmi hyp chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> age   0   1   1   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bmi   1   0   1   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> hyp   1   1   0   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> chl   1   1   1   0</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># list the actual imputations for BMI</span></span>
<span class='r-in'><span class='va'>imp</span><span class='op'>$</span><span class='va'>imp</span><span class='op'>$</span><span class='va'>bmi</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       1    2    3    4    5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  26.3 27.4 30.1 30.1 33.2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3  22.0 27.2 28.7 27.2 35.3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4  30.1 24.9 25.5 20.4 20.4</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6  25.5 21.7 20.4 25.5 22.5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10 20.4 27.5 35.3 22.0 22.5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11 27.2 29.6 26.3 29.6 29.6</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12 20.4 20.4 29.6 22.7 27.4</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 16 22.7 22.0 28.7 30.1 35.3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 21 30.1 25.5 28.7 26.3 27.5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># first completed data matrix</span></span>
<span class='r-in'><span class='fu'><a href='complete.mids.html'>complete</a></span><span class='op'>(</span><span class='va'>imp</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    age  bmi hyp chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1    1 26.3   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2    2 22.7   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3    1 22.0   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4    3 30.1   1 184</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5    1 20.4   1 113</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6    3 25.5   2 184</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7    1 22.5   1 118</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8    1 30.1   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9    2 22.0   1 238</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10   2 20.4   1 238</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11   1 27.2   1 199</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12   2 20.4   1 199</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 13   3 21.7   1 206</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 14   2 28.7   2 204</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 15   1 29.6   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 16   1 22.7   1 187</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 17   3 27.2   2 284</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 18   2 26.3   2 199</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 19   1 35.3   1 218</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 20   3 25.5   2 204</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 21   1 30.1   1 229</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 22   1 33.2   1 229</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 23   1 27.5   1 131</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 24   3 24.9   1 206</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 25   2 27.4   1 186</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># imputation on mixed data with a different method per column</span></span>
<span class='r-in'><span class='fu'>mice</span><span class='op'>(</span><span class='va'>nhanes2</span>, meth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sample"</span>, <span class='st'>"pmm"</span>, <span class='st'>"logreg"</span>, <span class='st'>"norm"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  iter imp variable</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Class: mids</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of multiple imputations:  5 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Imputation methods:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      age      bmi      hyp      chl </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       ""    "pmm" "logreg"   "norm" </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> PredictorMatrix:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     age bmi hyp chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> age   0   1   1   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bmi   1   0   1   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> hyp   1   1   0   1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> chl   1   1   1   0</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stef van Buuren, Karin Groothuis-Oudshoorn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '491b6c2ead7f15b8c26c513b923dd6a0',
    indexName: 'mice',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


